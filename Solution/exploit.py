
keystream = [1,1,0,0,1,0,1,0,1,1,1,1,1,1,1,0]+[0]*(214899*8)

for i in range(16,214899*8):
  keystream[i] = keystream[i-1]^keystream[i-3]^keystream[i-11]^keystream[i-16] #feedback polynomial
p = open('top_secret.zip','wb')

Cipher = open('top_secret.zip.encrypt','rb').read()
idx = 0
for c in Cipher:
  k = 0
  for i in range(8):
    k <<= 1
    k = k | keystream[idx]
    idx += 1
  p.write(bytes([c^k]))
p.close()
